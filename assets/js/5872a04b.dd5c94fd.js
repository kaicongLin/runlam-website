(self.webpackChunkrunlam_website=self.webpackChunkrunlam_website||[]).push([[5578],{4340:(e,l,n)=>{"use strict";n.r(l),n.d(l,{default:()=>L});var s=n(6540),a=n(781),t=n(7649),o=n(2828),r=n(512),i=n(349),c=n(7119);const d=10,m={"\u9001\u8d27\u5355\u53f7":"delivery_number","\u5ba2\u6237\u7f16\u53f7":"customer_number","\u5ba2\u6237\u8ba2\u5355\u53f7":"customer_order_number","\u8d27\u53f7":"product_number","\u54c1\u540d":"product_name","\u989c\u8272\u7f16\u53f7":"color_number","\u989c\u8272\u540d\u79f0":"color_name","\u7f38\u53f7":"dyeing_vat_number","\u5377\u53f7":"roll_number","\u6570\u91cf":"quantity","\u51c0\u603b(KG)":"net_total_kg","\u6263\u5e93\u5b58\u6570":"deducted_stock_number","\u5355\u4ef7":"unit_price","\u9644\u4ef6\u8d39":"accessory_fee","\u5355\u4f4d":"unit","\u5ba2\u6237\u8d27\u53f7":"customer_product_number","\u5ba2\u6237\u8272\u53f7":"customer_color_number","\u5907\u6ce8":"remark","\u526f\u5bbd":"sub_width","\u514b\u91cd":"gram_weight","\u4ed3\u4f4d":"storage_location"},u=[{name:"\u7bb1\u865f",englishName:"No. of Ctn",key:"case_number",width:18},{name:"\u7bb1/\u5377\u6578",englishName:"Ctn/Roll Qty.",key:"roll_qty",width:12},{name:"\u55ae\u4f4d",englishName:"Unit",key:"unit",width:26},{name:"\u5408\u540c\u865f",englishName:"Order No",key:"order_no",width:18},{name:"\u6210\u4efd",englishName:"Compostion",key:"compostion",width:16},{name:"\u843d\u8ca8\u7269\u6599",englishName:"Description",key:"description",width:16},{name:"\u984f\u8272",englishName:"Color",key:"color",width:24},{name:"\u5c01\u5ea6/\u5be6\u7528",englishName:"Width",key:"width",width:12},{name:"\u6578\u91cf",englishName:"Qty",key:"qty",width:12},{name:"\u55ae\u4f4d",englishName:"Unit",key:"length_unit",width:12},{name:"\u6de8\u91cd",englishName:"N/W",key:"net_weight",width:12},{name:"\u6bdb\u91cd",englishName:"G/W",key:"gross_weight",width:12},{name:"\u5c3a\u5bf8 (cm)",englishName:"Meas.",key:"meas",width:12},{name:"\u5099\u8a3b",englishName:"Remark",key:"remark",width:30}],N={"N3333-140R":"Recycle Nylon87% Spandex13%","N3333-140P":"Nylon87% Spandex13%","N3333-140":"Nylon87% Spandex13%","N3333-130R":"Recycle Nylon87% Spandex13%","N3333-130P":"Nylon87% Spandex13%","N3333-130C":"Nylon87% Spandex13%","N3333-130":"Nylon87% Spandex13%","N3350-165R":"Recycle Nylon 82% Spandex 18%","N3350-160":"Nylon82% Spandex18%","N3350-150R":"Recycle Nylon 82% Spandex 18%","N3350-150P":"Nylon82% Spandex18%","N3350-150":"Nylon82% Spandex18%","N3350-140R":"Recycle Nylon 82% Spandex 18%","N3350-135":"Nylon79% Spandex21%","N3350-130V":"Nylon82% Spandex18%","N3350-130R":"Recycle Nylon 82% Spandex 18%","N3350-130P":"Nylon82% Spandex18%","N3350-130F":"Nylon82% Spandex18%","N3350-130BIO":"BIO PA56 82% Spandex18%","N3350-130":"Nylon82% Spandex18%","N3350-125P":"Nylon82% Spandex18%","N3350-125":"Nylon82% Spandex18%",N3328V:"Nylon90% Spandex10%",N3328RP:"Re Nylon90% Spandex10%",N3328R:"Recycle Nylon90% Spandex10%",N3328P:"Nylon90% Spandex10%",N3328C:"Nylon90% Spandex10%","N3328-180":"Nylon90% Spandex10%","N3328-170P":"Nylon90% Spandex10%","N3328-170":"Nylon90% Spandex10%","N3328-150P":"Nylon 90% Spandex 10%","N3328-150":"Nylon90% Spandex10%","N3328-140R":"Recycled Nylon 92% Spandex 8%","N3328-140P":"Nylon90% Spandex10%","N3328-140":"Nylon90% Spandex10%","N3328-135":"Nylon90% Spandex10%","N3328-120":"Nylon90% Spandex10%",N3328:"Nylon90% Spandex10%",N4387R:"Recycle Nylon76% Spandex24%",N4387P:"Nylon76% Spandex24%","N4387-200R":"Recycle Nylon76% Spandex24%","N4387-200P":"Nylon76% Spandex24%","N4387-200DR":"Recycle Nylon76% Spandex24%","N4387-200DP":"Nylon76% Spandex24%","N4387-200D":"Nylon76% Spandex24%","N4387-200A":"Nylon76% Spandex24%","N4387-200":"Nylon76% Spandex24%","N4387-190":"Nylon76% Spandex24%","N4387-180":"Nylon76% Spandex24%","N4387-170P":"Nylon76% Spandex24%","N4387-170F":"Nylon76% Spandex24%","N4387-170":"Nylon76% Spandex24%","N4387-160":"Nylon75% Spandex25%","N4387-1":"Nylon76% Spandex24%",N4387:"Nylon76% Spandex24%","N1066R-125":"Recycle Nylon 67% Spandex 33%",N1066R:"Recycle Nylon 67% Spandex 33%",N1066P:"Nylon 67% Spandex 33%",N1066F:"Nylon 67% Spandex 33%","N1066-140R":"Recycle Nylon 67% Spandex 33%","N1066-140":"Nylon 67% Spandex 33%","N1066-130E":"Nylon 67% Spandex 33%","N1066-130":"Nylon 67% Spandex 33%",N1066:"Nylon 67% Spandex 33%",N1018RP:"Recycle Nylon69%,Spandex31%",N1018RM2:"Recycle Nylon69%,Spandex31%",N1018RL:"Recycle Nylon 69%,Lycra 31%",N1018R:"Recycle Nylon 69%,Spandex31%",N1018P:"Nylon69%,Spandex31%",N1018M2:"Nylon69%,Spandex31%",N1018L:"Nylon 69%,Lycra 31%",N1018:"Nylon69%,Spandex31%",N1012RM:"Recycle Nylon 57%,Spandex 43%",N1012R:"Recycle Nylon 57%,Spandex 43%",N1012M:"Nylon 57%,Spandex 43%","N1012-250":"Nylon 57%,Spandex 43%","N1012-230M":"Nylon 57%,Spandex 43%","N1012-230":"Nylon 57%,Spandex 43%","N1012-200R":"Recycle Nylon 57%,Spandex 43%","N1012-200H":"Nylon 57%,Spandex 43%","N1012-200BIO":"BIO Nylon\uff08PA56) 57% Spandex 43%","N1012-200":"Nylon 57%,Spandex 43%","N1012-190R":"Recycle Nylon 57%,Spandex 43%","N1012-190":"Nylon 57%,Spandex 43%","N1012-185R":"Recycle Nylon 57%,Spandex 43%","N1012-185":"Nylon 57%,Spandex 43%","N1012-1":"Nylon 57%,Spandex 43%",N1012:"Nylon 57%,Spandex 43%",W2310L:"Nylon85% Lycra 15%","W2310-210":"Nylon 85% Spandex15%","W2310-200":"Nylon 85% Spandex15%","W2310-190M":"Nylon 85% Spandex15%","W2310-190":"Nylon 85% Spandex15%","W2310-180":"Nylon 85% Spandex15%",W2310:"Nylon85% Spandex15%","N1092-190":"Nylon 59 % Spandex 41 %",N1092:"Nylon 59 % Spandex 41 %",N4526RP:"Recycle Nylon 67% Spandex 33%",N4526R:"Recycle Nylon 67% Spandex 33%",N4526P:"Nylon 67% Spandex 33%","N4526-1P":"Nylon 67% Spandex 33%","N4526-1":"Nylon 67% Spandex 33%",N4526:"Nylon 67% Spandex 33%"},y={"delivery-wrap":"delivery-wrap_isro","delivery-content":"delivery-content_oEOO","deliver-right":"deliver-right_7cSX",step:"step_lsoV","basic-info-wrap":"basic-info-wrap_qxux","basic-info-form":"basic-info-form_Dibq","mb-10":"mb-10_INUI",second:"second_Sbfw",third:"third_qNy1","excel-preview":"excel-preview__Z5i","block-title":"block-title_JTDk","univer-container":"univer-container_hiRy"};var p=n(9540),h=n(4819),j=n(8425),g=n(4848);const x=s.forwardRef(((e,l)=>{let{onFormValueChange:n}=e;const[a]=p.A.useForm();s.useImperativeHandle(l,(()=>({getFieldsValue:t})));const t=()=>a.getFieldsValue();return(0,g.jsx)("div",{className:y["basic-info-wrap"],children:(0,g.jsxs)(p.A,{form:a,name:"basic",layout:"horizontal",className:y["basic-info-form"],labelCol:{span:8},wrapperCol:{span:16},onChange:n,children:[(0,g.jsx)("div",{className:y["block-title"],children:"\u57fa\u7840\u4fe1\u606f\u5b57\u6bb5"}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"invoice no.",name:"invoice_no",initialValue:"LS20241007sea",rules:[{required:!0,message:"Please input invoice no.!"}],children:(0,g.jsx)(h.A,{})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"packing list no.",name:"packing_list_no",initialValue:"R037/24",rules:[{required:!0,message:"Please input packing list no.!"}],children:(0,g.jsx)(h.A,{})}),(0,g.jsx)("div",{className:y["block-title"],children:"\u8868\u683c\u5217\u5b57\u6bb5"}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u7bb1\u865f",name:"case_number",tooltip:"\u8f93\u5165\u521d\u59cb\u7bb1\u53f7\uff0c\u5982\uff1a33S37-24-11384, \u540e\u9762\u884c\u4f1a\u81ea\u52a8\u9012\u589e\uff08x-x-11385\uff0c x-x-1386...\uff09",initialValue:"33S37-24-11384",rules:[{required:!0,pattern:/^[^\s-]+-[^\s-]+-\d+$/,message:"\u8bf7\u8f93\u5165\u683c\u5f0f\u4e3a x-x-x \u7684\u5185\u5bb9, \u6700\u540ex\u9700\u8981\u4e3a\u6570\u5b57"}],children:(0,g.jsx)(h.A,{})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u7bb1/\u5377\u6578",name:"roll_qty",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"1",rules:[{required:!0,message:"Please input roll qty!"}],children:(0,g.jsx)(j.A,{style:{width:"100%"}})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u55ae\u4f4d",name:"unit",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"ROLL",rules:[{required:!0,message:"Please input unit!"}],children:(0,g.jsx)(h.A,{})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u5408\u540c\u865f",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u5ba2\u6237\u8ba2\u5355\u53f7'"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u6210\u4efd",children:(0,g.jsx)("div",{children:"\u6839\u636e\u9001\u8d27\u5355\u7684'\u8d27\u53f7'\u81ea\u52a8\u5339\u914d"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u843d\u8ca8\u7269\u6599",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u8d27\u53f7'"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u984f\u8272",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u989c\u8272\u540d\u79f0 '"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u5c01\u5ea6/\u5be6\u7528",name:"width",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"150CM",rules:[{required:!0,message:"Please input width!"}],children:(0,g.jsx)(h.A,{})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u6578\u91cf",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u6570\u91cf '"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u55ae\u4f4d",tooltip:"Y \u4f1a \u81ea\u52a8\u8f6c\u6210 YD\uff0c\u5176\u4ed6\u4e0d\u53d8",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u5355\u4f4d '"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u6de8\u91cd",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u51c0\u603b(KG) '"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u6bdb\u91cd",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u51c0\u603b(KG) + 0.5'"})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u5c3a\u5bf8 (cm)",name:"meas",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"26*26*153",rules:[{required:!0,message:"Please input meas!"}],children:(0,g.jsx)(h.A,{})}),(0,g.jsx)(p.A.Item,{className:y["mb-10"],label:"\u5099\u8a3b",tooltip:"\u751f\u6210\u89c4\u5219\uff1a\u5ba2\u6237\u8ba2\u5355\u53f7\uff0c\u8d27\u53f7\uff0c\u989c\u8272\u7f16\u53f7\uff0c\u989c\u8272\u540d\u79f0\uff0c \u7f38\u53f7\uff0c\u5171'{'\u9001\u8d27\u5355\u5377\u6570'}'\u5377\r \u62a5\u544a OK",children:(0,g.jsx)("div",{children:"\u81ea\u52a8\u751f\u6210"})})]})})}));var b=n(4974),v=n.n(b);n(1383);const S=async e=>{const l=[],n=[];for(const s of e){const e=new FileReader;e.readAsArrayBuffer(s);const a=new Promise(((n,a)=>{e.onload=async e=>{const a=e.target?.result,t=new(v().Workbook);await t.xlsx.load(a);const o=t.getWorksheet("\u9001\u8d27\u5355\u660e\u7ec6"),r=[];o.eachRow(((e,l)=>{const n={};e.eachCell({includeEmpty:!0},((e,l)=>{n[m[o.getCell(1,l).value]]=e.value})),1!==l&&r.push(n)}));const i=s.name.match(/[\u4e00-\u9fa5]+/);l.push({name:i?i[0]:s.name,deliveryList:r}),n()},e.onerror=a}));n.push(a)}return await Promise.all(n),l},f=(e,l)=>{const n=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),s=URL.createObjectURL(n),a=document.createElement("a");a.setAttribute("download",l||`${(new Date).getTime()}.xlsx`),a.setAttribute("href",s),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(n)};function _(e){return function(e){let l="",n=e;for(;n>0;){n--;let e=n%26;l=String.fromCharCode(e+65)+l,n=Math.floor(n/26)}return l||"A"}(u.findIndex((l=>l.key===e))+1)}var w=n(2543),k=n.n(w),R=n(5093),C=n.n(R);const A={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"},diagonal:{style:"thin"}},$=async(e,l)=>{const n=new(v().Workbook),s=n.addWorksheet(C()().format("YYYYMMDD")),a=u;if(s.columns=a,((e,l)=>{e.getCell("A1").value="Lintas Company Limited",e.getCell("A2").value="2A, Dragon Industrial Bldg., 93 King Lam Street, Cheung Sha Wan, Kowloon, Hong Kong.",e.getCell("A3").value="Tel : (852) 2311 8028 / Fax : (852) 2311 2262",e.getCell("A4").value="DELIVERY TO : Lintas Bangladesh Co. Ltd.",e.getCell("A5").value="SFB # 5, Adamjee Export Processing Zone;Siddhirganj, Narayanganj, Bangladesh ",e.getCell("A6").value="VAT + BIN no. 000150053-0305      ATTN: Mr. Sujit        Tel no. 8801774-950646",e.getCell("A7").value="TEL : (852) 2311 8028 ",e.getCell("A8").value="***packing list ***(UPDATE)",e.mergeCells("A8:N8"),e.getCell("D9").value="Invoice no.",e.getCell("E9").value=l.invoice_no,e.getCell("F9").value="packing list no.",e.getCell("G9").value=l.packing_list_no,e.getCell("H9").value="Date",e.getCell("I9").value=new Date,e.getCell("I9").numFmt="d-mmm-yy",e.eachRow((e=>{e.eachCell((e=>{e.font={name:"Calibri",size:11}}))})),e.getRow(d).values=u.map((e=>e.englishName)),e.getRow(d).font={name:"Tahoma",size:11},e.getRow(11).values=u.map((e=>e.name)),e.getRow(11).font={name:"Tahoma",size:11}})(s,e),l.length<1)return n;let t=-1;l.forEach((l=>{const n=l.deliveryList.map((n=>{const s=[...new Set(l.deliveryList.map((e=>e.dyeing_vat_number)))],a=e.case_number.split("-"),o=a[0]+"-"+a[1]+"-",r=a[2];t++;const i=N[n.product_number];return{case_number:`${o}${Number(r)+t}`,roll_qty:Number(e.roll_qty),unit:e.unit,order_no:n.customer_order_number??"error",compostion:i??"error",description:n.product_number??"error",color:n.color_name??"error",width:e.width,qty:n.quantity??"error",length_unit:"Y"===n.unit?"YD":n.unit??"error",net_weight:n.net_total_kg??"error",gross_weight:n.net_total_kg?n.net_total_kg+.5:"error",meas:e.meas,remark:`${n.customer_order_number??""}, ${n.product_number??""}, ${n.color_number??""}, ${n.color_name??""}\n\n\u7f38\u53f7${s.map((e=>e)).join("\u3001")}, \u5171${l.deliveryList.length??0}\u5377 \u62a5\u544aOK`}})),o=s.lastRow.number;s.addRows(n).map((e=>{e.font={name:"Tahoma",size:10};const l=a.findIndex((e=>"gross_weight"===e.key))+1,n=_("net_weight");e.getCell(l).value={formula:`${n}${e.number}+0.5`}}));const r=_("remark");s.mergeCells(`${r}${o+1}:${r}${o+n.length}`);const i={roll_qty:l.deliveryList.length,qty:l.deliveryList.reduce(((e,l)=>e+Number(l.quantity??0)),0),net_weight:l.deliveryList.reduce(((e,l)=>e+Number(l.net_total_kg??0)),0),gross_weight:l.deliveryList.reduce(((e,l)=>e+Number(l.net_total_kg??0)+.5),0),remark:"\u5408\u8ba1"},c=s.addRow(i);c.eachCell({includeEmpty:!0},(e=>{if("roll_qty"===e._column._key){const l=_("roll_qty");e.value={formula:`SUM(${l}${o+1}:${l}${c.number-1})`,result:i.roll_qty}}if("qty"===e._column._key){const l=_("qty");e.value={formula:`SUM(${l}${o+1}:${l}${c.number-1})`,result:i.qty}}if("net_weight"===e._column._key){const l=_("net_weight");e.value={formula:`SUM(${l}${o+1}:${l}${c.number-1})`,result:i.net_weight}}if("gross_weight"===e._column._key){const l=_("gross_weight");e.value={formula:`SUM(${l}${o+1}:${l}${c.number-1})`,result:i.gross_weight}}e.border=A,e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.font={name:"Tahoma",size:10,bold:!0,color:{argb:"FFFF0000"}}}))})),s.getRow(s.lastRow.number+1).height=80;const o=s.lastRow.number+1;let r=11;l.forEach(((e,l)=>{const n=s.getRow(o+l),a=e.deliveryList[0];r+=e.deliveryList.length+1,n.getCell(1).value=a.customer_order_number,n.getCell(2).value=a.product_number,n.getCell(3).value=a.color_name,n.getCell(4).value="SUM:",n.getCell(5).value="rolls",n.getCell(6).value={formula:`B${r}`},n.getCell(7).value="Y"===a.unit?"YD":a.unit,n.getCell(8).value={formula:`I${r}`},n.getCell(9).value="NET:",n.getCell(10).value={formula:`K${r}`},n.getCell(11).value="GROSS:",n.getCell(12).value={formula:`L${r}`},n.getCell(13).value={formula:"N"+(r-e.deliveryList.length)},n.font={name:"Tahoma",size:10},s.mergeCells(`M${n.number}:N${n.number}`)}));const i=s.getRow(s.lastRow.number+1);return i.getCell(4).value="TOTAL:",i.getCell(5).value="rolls",i.getCell(6).value={formula:`SUM(F${o}:F${o+l.length-1})`},i.getCell(7).value="Y"===l[0].deliveryList[0].unit?"YD":l[0].deliveryList[0].unit,i.getCell(8).value={formula:`SUM(H${o}:H${o+l.length-1})`},i.getCell(9).value="NET:",i.getCell(10).value={formula:`SUM(J${o}:J${o+l.length-1})`},i.getCell(11).value="GROSS:",i.getCell(12).value={formula:`SUM(L${o}:L${o+l.length-1})`},i.eachCell((e=>{e.border=A,e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.font={name:"Tahoma",size:10,bold:!0,color:{argb:"FFFF0000"}}})),s.eachRow(((e,l)=>{e.eachCell(((e,n)=>{l>7&&(e.alignment={horizontal:"center",vertical:"middle",wrapText:!0}),l>9&&n<a.length+1&&(e.border=A)})),l>11&&(e.height=80)})),n};function L(){const[e,l]=s.useState([]),[n,d]=s.useState([]),[u,N]=s.useState([]),[p,h]=s.useState(),[j,b]=s.useState(null),v=(0,s.useRef)(!1),_=(0,s.useRef)(0),w=(0,s.useRef)(),R={name:"file",multiple:!0,fileList:u,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",customRequest:async e=>{const{onSuccess:l,file:n}=e;return l({status:"success",response:n}),{abort(){}}},onChange:async e=>{if(v.current)return void(v.current=!1);_.current++;const l=e.fileList.every((e=>"done"===e.status));if(_.current===e.fileList.length&&!l){const l=e.fileList.filter((e=>"uploading"===e.status)).length,n=e.fileList.map((e=>({...e,status:"done"})));N(n),_.current-=l}_.current===e.fileList.length&&l&&(o.Ay.success(`total ${e.fileList.length} file load successfully.`),C(e.fileList))},onRemove:async e=>{const l=u.filter((l=>l.uid!==e.uid));N(l),o.Ay.success(`remove ${e.name} file successfully.`),_.current--,v.current=!0,C(l)}},C=async e=>{const n=w.current?.getFieldsValue();let s=[];console.log(e),e&&(s=await S(e.map((e=>e.originFileObj))),l(s));const a=await $(n,s),t=await a.xlsx.writeBuffer();h(t),b(a)};(0,s.useEffect)((()=>{const e=[];for(const[l,n]of Object.entries(m))e.push({title:l,dataIndex:n,key:n});d(e),C()}),[]);k().flatMap(e,(e=>e.deliveryList));return(0,g.jsx)(a.A,{title:"Hello",description:"Hello React Page",children:(0,g.jsx)("div",{className:y["delivery-wrap"],children:(0,g.jsxs)("div",{className:y["delivery-content"],children:[(0,g.jsx)("div",{className:y["excel-preview"]}),(0,g.jsxs)("div",{className:y["deliver-right"],children:[(0,g.jsxs)("div",{className:y.first,children:[(0,g.jsxs)("span",{style:{marginRight:"8px"},children:[(0,g.jsx)("div",{className:y.step,children:"1"}),"\u4e0a\u4f20\u9001\u8d27\u5355"]}),(0,g.jsx)(r.A,{...R,children:(0,g.jsx)(i.Ay,{type:"primary",icon:(0,g.jsx)(t.A,{}),children:"Upload"})})]}),(0,g.jsxs)("div",{className:y.second,children:[(0,g.jsx)("div",{className:y.step,children:"2"}),"\u4fee\u6539\u6838\u5bf9\u5b57\u6bb5\u4fe1\u606f",(0,g.jsx)(x,{ref:w,onFormValueChange:k().debounce((()=>C(u)),500)})]}),(0,g.jsxs)("div",{className:y.third,children:[(0,g.jsxs)("span",{style:{marginRight:"8px"},children:[(0,g.jsx)("div",{className:y.step,children:"3"}),"\u5bfc\u51fa\u88c5\u7bb1\u5355"]}),(0,g.jsx)(c.A,{offsetBottom:0,children:(0,g.jsx)(i.Ay,{type:"primary",onClick:async()=>{const l=w.current?.getFieldsValue(),n=e.reduce(((e,l)=>e+l.deliveryList.length),0);f(p,`${l.invoice_no}\u88c5\u7bb1\u5355${n}\u5377.xlsx`)},children:"\u5bfc\u51fa\u88c5\u7bb1\u5355"})})]})]})]})})})}},5358:(e,l,n)=>{var s={"./af":5177,"./af.js":5177,"./ar":1509,"./ar-dz":1488,"./ar-dz.js":1488,"./ar-kw":8676,"./ar-kw.js":8676,"./ar-ly":2353,"./ar-ly.js":2353,"./ar-ma":4496,"./ar-ma.js":4496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":2682,"./ar-sa.js":2682,"./ar-tn":9756,"./ar-tn.js":9756,"./ar.js":1509,"./az":5533,"./az.js":5533,"./be":8959,"./be.js":8959,"./bg":7777,"./bg.js":7777,"./bm":4903,"./bm.js":4903,"./bn":1290,"./bn-bd":7357,"./bn-bd.js":7357,"./bn.js":1290,"./bo":1545,"./bo.js":1545,"./br":9089,"./br.js":9089,"./bs":4429,"./bs.js":4429,"./ca":7306,"./ca.js":7306,"./cs":6464,"./cs.js":6464,"./cv":3635,"./cv.js":3635,"./cy":4226,"./cy.js":4226,"./da":3601,"./da.js":3601,"./de":7853,"./de-at":6111,"./de-at.js":6111,"./de-ch":4697,"./de-ch.js":4697,"./de.js":7853,"./dv":708,"./dv.js":708,"./el":4691,"./el.js":4691,"./en-au":3872,"./en-au.js":3872,"./en-ca":8298,"./en-ca.js":8298,"./en-gb":6195,"./en-gb.js":6195,"./en-ie":6584,"./en-ie.js":6584,"./en-il":5543,"./en-il.js":5543,"./en-in":9033,"./en-in.js":9033,"./en-nz":9402,"./en-nz.js":9402,"./en-sg":3004,"./en-sg.js":3004,"./eo":2934,"./eo.js":2934,"./es":7650,"./es-do":838,"./es-do.js":838,"./es-mx":7730,"./es-mx.js":7730,"./es-us":6575,"./es-us.js":6575,"./es.js":7650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":2500,"./fa.js":2500,"./fi":527,"./fi.js":527,"./fil":5995,"./fil.js":5995,"./fo":2477,"./fo.js":2477,"./fr":5498,"./fr-ca":6435,"./fr-ca.js":6435,"./fr-ch":7892,"./fr-ch.js":7892,"./fr.js":5498,"./fy":7071,"./fy.js":7071,"./ga":1734,"./ga.js":1734,"./gd":217,"./gd.js":217,"./gl":7329,"./gl.js":7329,"./gom-deva":2124,"./gom-deva.js":2124,"./gom-latn":3383,"./gom-latn.js":3383,"./gu":5050,"./gu.js":5050,"./he":1713,"./he.js":1713,"./hi":3861,"./hi.js":3861,"./hr":6308,"./hr.js":6308,"./hu":2990,"./hu.js":2990,"./hy-am":7160,"./hy-am.js":7160,"./id":4063,"./id.js":4063,"./is":9374,"./is.js":9374,"./it":8383,"./it-ch":1827,"./it-ch.js":1827,"./it.js":8383,"./ja":3827,"./ja.js":3827,"./jv":9722,"./jv.js":9722,"./ka":1794,"./ka.js":1794,"./kk":7088,"./kk.js":7088,"./km":6870,"./km.js":6870,"./kn":4451,"./kn.js":4451,"./ko":3164,"./ko.js":3164,"./ku":8174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":8174,"./ky":8474,"./ky.js":8474,"./lb":9680,"./lb.js":9680,"./lo":5867,"./lo.js":5867,"./lt":5766,"./lt.js":5766,"./lv":7151,"./lv.js":7151,"./me":8076,"./me.js":8076,"./mi":1848,"./mi.js":1848,"./mk":306,"./mk.js":306,"./ml":3739,"./ml.js":3739,"./mn":9053,"./mn.js":9053,"./mr":6169,"./mr.js":6169,"./ms":3386,"./ms-my":2297,"./ms-my.js":2297,"./ms.js":3386,"./mt":7075,"./mt.js":7075,"./my":2264,"./my.js":2264,"./nb":2274,"./nb.js":2274,"./ne":8235,"./ne.js":8235,"./nl":2572,"./nl-be":3784,"./nl-be.js":3784,"./nl.js":2572,"./nn":4566,"./nn.js":4566,"./oc-lnc":9330,"./oc-lnc.js":9330,"./pa-in":9849,"./pa-in.js":9849,"./pl":4418,"./pl.js":4418,"./pt":9834,"./pt-br":8303,"./pt-br.js":8303,"./pt.js":9834,"./ro":4457,"./ro.js":4457,"./ru":2271,"./ru.js":2271,"./sd":1221,"./sd.js":1221,"./se":3478,"./se.js":3478,"./si":7538,"./si.js":7538,"./sk":5784,"./sk.js":5784,"./sl":6637,"./sl.js":6637,"./sq":6794,"./sq.js":6794,"./sr":5719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":5719,"./ss":6e3,"./ss.js":6e3,"./sv":1011,"./sv.js":1011,"./sw":748,"./sw.js":748,"./ta":1025,"./ta.js":1025,"./te":1885,"./te.js":1885,"./tet":8861,"./tet.js":8861,"./tg":6571,"./tg.js":6571,"./th":5802,"./th.js":5802,"./tk":9527,"./tk.js":9527,"./tl-ph":9231,"./tl-ph.js":9231,"./tlh":1052,"./tlh.js":1052,"./tr":5096,"./tr.js":5096,"./tzl":9846,"./tzl.js":9846,"./tzm":6527,"./tzm-latn":7711,"./tzm-latn.js":7711,"./tzm.js":6527,"./ug-cn":8414,"./ug-cn.js":8414,"./uk":6618,"./uk.js":6618,"./ur":158,"./ur.js":158,"./uz":7609,"./uz-latn":2475,"./uz-latn.js":2475,"./uz.js":7609,"./vi":1135,"./vi.js":1135,"./x-pseudo":4051,"./x-pseudo.js":4051,"./yo":2218,"./yo.js":2218,"./zh-cn":2648,"./zh-cn.js":2648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":1541,"./zh-mo.js":1541,"./zh-tw":304,"./zh-tw.js":304};function a(e){var l=t(e);return n(l)}function t(e){if(!n.o(s,e)){var l=new Error("Cannot find module '"+e+"'");throw l.code="MODULE_NOT_FOUND",l}return s[e]}a.keys=function(){return Object.keys(s)},a.resolve=t,e.exports=a,a.id=5358}}]);