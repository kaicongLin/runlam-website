(self.webpackChunkrunlam_website=self.webpackChunkrunlam_website||[]).push([[5578],{41610:(e,n,l)=>{"use strict";l.r(n),l.d(n,{default:()=>E});var s=l(96540),t=l(10781),a=l(27649),o=l(2828),r=l(90512),i=l(60349),c=l(47119);const d=10,m={"\u9001\u8d27\u5355\u53f7":"delivery_number","\u5ba2\u6237\u7f16\u53f7":"customer_number","\u5ba2\u6237\u8ba2\u5355\u53f7":"customer_order_number","\u8d27\u53f7":"product_number","\u54c1\u540d":"product_name","\u989c\u8272\u7f16\u53f7":"color_number","\u989c\u8272\u540d\u79f0":"color_name","\u7f38\u53f7":"dyeing_vat_number","\u5377\u53f7":"roll_number","\u6570\u91cf":"quantity","\u51c0\u603b(KG)":"net_total_kg","\u6263\u5e93\u5b58\u6570":"deducted_stock_number","\u5355\u4ef7":"unit_price","\u9644\u4ef6\u8d39":"accessory_fee","\u5355\u4f4d":"unit","\u5ba2\u6237\u8d27\u53f7":"customer_product_number","\u5ba2\u6237\u8272\u53f7":"customer_color_number","\u5907\u6ce8":"remark","\u526f\u5bbd":"sub_width","\u514b\u91cd":"gram_weight","\u4ed3\u4f4d":"storage_location"},u=[{name:"\u7bb1\u865f",englishName:"No. of Ctn",key:"case_number",width:18},{name:"\u7bb1/\u5377\u6578",englishName:"Ctn/Roll Qty.",key:"roll_qty",width:12},{name:"\u55ae\u4f4d",englishName:"Unit",key:"unit",width:26},{name:"\u5408\u540c\u865f",englishName:"Order No",key:"order_no",width:18},{name:"\u6210\u4efd",englishName:"Compostion",key:"compostion",width:16},{name:"\u843d\u8ca8\u7269\u6599",englishName:"Description",key:"description",width:16},{name:"\u984f\u8272",englishName:"Color",key:"color",width:24},{name:"\u5c01\u5ea6/\u5be6\u7528",englishName:"Width",key:"width",width:12},{name:"\u6578\u91cf",englishName:"Qty",key:"qty",width:12},{name:"\u55ae\u4f4d",englishName:"Unit",key:"length_unit",width:12},{name:"\u6de8\u91cd",englishName:"N/W",key:"net_weight",width:12},{name:"\u6bdb\u91cd",englishName:"G/W",key:"gross_weight",width:12},{name:"\u5c3a\u5bf8 (cm)",englishName:"Meas.",key:"meas",width:12},{name:"\u5099\u8a3b",englishName:"Remark",key:"remark",width:30}],y={"N3333-140R":"Recycle Nylon87% Spandex13%","N3333-140P":"Nylon87% Spandex13%","N3333-140":"Nylon87% Spandex13%","N3333-130R":"Recycle Nylon87% Spandex13%","N3333-130P":"Nylon87% Spandex13%","N3333-130C":"Nylon87% Spandex13%","N3333-130":"Nylon87% Spandex13%","N3350-165R":"Recycle Nylon 82% Spandex 18%","N3350-160":"Nylon82% Spandex18%","N3350-150R":"Recycle Nylon 82% Spandex 18%","N3350-150P":"Nylon82% Spandex18%","N3350-150":"Nylon82% Spandex18%","N3350-140R":"Recycle Nylon 82% Spandex 18%","N3350-135":"Nylon79% Spandex21%","N3350-130V":"Nylon82% Spandex18%","N3350-130R":"Recycle Nylon 82% Spandex 18%","N3350-130P":"Nylon82% Spandex18%","N3350-130F":"Nylon82% Spandex18%","N3350-130BIO":"BIO PA56 82% Spandex18%","N3350-130":"Nylon82% Spandex18%","N3350-125P":"Nylon82% Spandex18%","N3350-125":"Nylon82% Spandex18%",N3328V:"Nylon90% Spandex10%",N3328RP:"Re Nylon90% Spandex10%",N3328R:"Recycle Nylon90% Spandex10%",N3328P:"Nylon90% Spandex10%",N3328C:"Nylon90% Spandex10%","N3328-180":"Nylon90% Spandex10%","N3328-170P":"Nylon90% Spandex10%","N3328-170":"Nylon90% Spandex10%","N3328-150P":"Nylon 90% Spandex 10%","N3328-150":"Nylon90% Spandex10%","N3328-140R":"Recycled Nylon 92% Spandex 8%","N3328-140P":"Nylon90% Spandex10%","N3328-140":"Nylon90% Spandex10%","N3328-135":"Nylon90% Spandex10%","N3328-120":"Nylon90% Spandex10%",N3328:"Nylon90% Spandex10%",N4387R:"Recycle Nylon76% Spandex24%",N4387P:"Nylon76% Spandex24%","N4387-200R":"Recycle Nylon76% Spandex24%","N4387-200P":"Nylon76% Spandex24%","N4387-200DR":"Recycle Nylon76% Spandex24%","N4387-200DP":"Nylon76% Spandex24%","N4387-200D":"Nylon76% Spandex24%","N4387-200A":"Nylon76% Spandex24%","N4387-200":"Nylon76% Spandex24%","N4387-190":"Nylon76% Spandex24%","N4387-180":"Nylon76% Spandex24%","N4387-170P":"Nylon76% Spandex24%","N4387-170F":"Nylon76% Spandex24%","N4387-170":"Nylon76% Spandex24%","N4387-160":"Nylon75% Spandex25%","N4387-1":"Nylon76% Spandex24%",N4387:"Nylon76% Spandex24%","N1066R-125":"Recycle Nylon 67% Spandex 33%",N1066R:"Recycle Nylon 67% Spandex 33%",N1066P:"Nylon 67% Spandex 33%",N1066F:"Nylon 67% Spandex 33%","N1066-140R":"Recycle Nylon 67% Spandex 33%","N1066-140":"Nylon 67% Spandex 33%","N1066-130E":"Nylon 67% Spandex 33%","N1066-130":"Nylon 67% Spandex 33%",N1066:"Nylon 67% Spandex 33%",N1018RP:"Recycle Nylon69%,Spandex31%",N1018RM2:"Recycle Nylon69%,Spandex31%",N1018RL:"Recycle Nylon 69%,Lycra 31%",N1018R:"Recycle Nylon 69%,Spandex31%",N1018P:"Nylon69%,Spandex31%",N1018M2:"Nylon69%,Spandex31%",N1018L:"Nylon 69%,Lycra 31%",N1018:"Nylon69%,Spandex31%",N1012RM:"Recycle Nylon 57%,Spandex 43%",N1012R:"Recycle Nylon 57%,Spandex 43%",N1012M:"Nylon 57%,Spandex 43%","N1012-250":"Nylon 57%,Spandex 43%","N1012-230M":"Nylon 57%,Spandex 43%","N1012-230":"Nylon 57%,Spandex 43%","N1012-200R":"Recycle Nylon 57%,Spandex 43%","N1012-200H":"Nylon 57%,Spandex 43%","N1012-200BIO":"BIO Nylon\uff08PA56) 57% Spandex 43%","N1012-200":"Nylon 57%,Spandex 43%","N1012-190R":"Recycle Nylon 57%,Spandex 43%","N1012-190":"Nylon 57%,Spandex 43%","N1012-185R":"Recycle Nylon 57%,Spandex 43%","N1012-185":"Nylon 57%,Spandex 43%","N1012-1":"Nylon 57%,Spandex 43%",N1012:"Nylon 57%,Spandex 43%",W2310L:"Nylon85% Lycra 15%","W2310-210":"Nylon 85% Spandex15%","W2310-200":"Nylon 85% Spandex15%","W2310-190M":"Nylon 85% Spandex15%","W2310-190":"Nylon 85% Spandex15%","W2310-180":"Nylon 85% Spandex15%",W2310:"Nylon85% Spandex15%","N1092-190":"Nylon 59 % Spandex 41 %",N1092:"Nylon 59 % Spandex 41 %",N4526RP:"Recycle Nylon 67% Spandex 33%",N4526R:"Recycle Nylon 67% Spandex 33%",N4526P:"Nylon 67% Spandex 33%","N4526-1P":"Nylon 67% Spandex 33%","N4526-1":"Nylon 67% Spandex 33%",N4526:"Nylon 67% Spandex 33%"},N={"delivery-wrap":"delivery-wrap_isro","delivery-content":"delivery-content_oEOO","deliver-right":"deliver-right_7cSX",step:"step_lsoV","basic-info-wrap":"basic-info-wrap_qxux","basic-info-form":"basic-info-form_Dibq","mb-10":"mb-10_INUI",second:"second_Sbfw",third:"third_qNy1","excel-preview":"excel-preview__Z5i","preiew-luckysheet":"preiew-luckysheet_lYdr","block-title":"block-title_JTDk"};var p=l(79540),h=l(54819),g=l(88425),j=l(74848);const x=s.forwardRef(((e,n)=>{let{onFormValueChange:l}=e;const[t]=p.A.useForm();s.useImperativeHandle(n,(()=>({getFieldsValue:a})));const a=()=>t.getFieldsValue();return(0,j.jsx)("div",{className:N["basic-info-wrap"],children:(0,j.jsxs)(p.A,{form:t,name:"basic",layout:"horizontal",className:N["basic-info-form"],labelCol:{span:8},wrapperCol:{span:16},onChange:l,children:[(0,j.jsx)("div",{className:N["block-title"],children:"\u57fa\u7840\u4fe1\u606f\u5b57\u6bb5"}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"invoice no.",name:"invoice_no",initialValue:"LS20241007sea",rules:[{required:!0,message:"Please input invoice no.!"}],children:(0,j.jsx)(h.A,{})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"packing list no.",name:"packing_list_no",initialValue:"R037/24",rules:[{required:!0,message:"Please input packing list no.!"}],children:(0,j.jsx)(h.A,{})}),(0,j.jsx)("div",{className:N["block-title"],children:"\u8868\u683c\u5217\u5b57\u6bb5"}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u7bb1\u865f",name:"case_number",tooltip:"\u8f93\u5165\u521d\u59cb\u7bb1\u53f7\uff0c\u5982\uff1a33S37-24-11384, \u540e\u9762\u884c\u4f1a\u81ea\u52a8\u9012\u589e\uff08x-x-11385\uff0c x-x-1386...\uff09",initialValue:"33S37-24-11384",rules:[{required:!0,pattern:/^[^\s-]+-[^\s-]+-\d+$/,message:"\u8bf7\u8f93\u5165\u683c\u5f0f\u4e3a x-x-x \u7684\u5185\u5bb9, \u6700\u540ex\u9700\u8981\u4e3a\u6570\u5b57"}],children:(0,j.jsx)(h.A,{})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u7bb1/\u5377\u6578",name:"roll_qty",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"1",rules:[{required:!0,message:"Please input roll qty!"}],children:(0,j.jsx)(g.A,{style:{width:"100%"}})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u55ae\u4f4d",name:"unit",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"ROLL",rules:[{required:!0,message:"Please input unit!"}],children:(0,j.jsx)(h.A,{})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u5408\u540c\u865f",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u5ba2\u6237\u8ba2\u5355\u53f7'"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u6210\u4efd",children:(0,j.jsx)("div",{children:"\u6839\u636e\u9001\u8d27\u5355\u7684'\u8d27\u53f7'\u81ea\u52a8\u5339\u914d"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u843d\u8ca8\u7269\u6599",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u8d27\u53f7'"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u984f\u8272",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u989c\u8272\u540d\u79f0 '"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u5c01\u5ea6/\u5be6\u7528",name:"width",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"150CM",rules:[{required:!0,message:"Please input width!"}],children:(0,j.jsx)(h.A,{})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u6578\u91cf",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u6570\u91cf '"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u55ae\u4f4d",tooltip:"Y \u4f1a \u81ea\u52a8\u8f6c\u6210 YD\uff0c\u5176\u4ed6\u4e0d\u53d8",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u5355\u4f4d '"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u6de8\u91cd",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u51c0\u603b(KG) '"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u6bdb\u91cd",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u5339\u914d\u9001\u8d27\u5355\u7684'\u51c0\u603b(KG) + 0.5'"})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u5c3a\u5bf8 (cm)",name:"meas",tooltip:"\u5bfc\u51fa\u8be5\u5217\u7684\u6240\u6709\u6570\u636e\u90fd\u4f1a\u7edf\u4e00\u4f7f\u7528\u8fd9\u4e2a\u503c\uff0c\u82e5\u6709\u4e2a\u522b\u4e0d\u540c\u9700\u8981\u624b\u52a8\u4fee\u6539",initialValue:"26*26*153",rules:[{required:!0,message:"Please input meas!"}],children:(0,j.jsx)(h.A,{})}),(0,j.jsx)(p.A.Item,{className:N["mb-10"],label:"\u5099\u8a3b",tooltip:"\u751f\u6210\u89c4\u5219\uff1a\u5ba2\u6237\u8ba2\u5355\u53f7\uff0c\u8d27\u53f7\uff0c\u989c\u8272\u7f16\u53f7\uff0c\u989c\u8272\u540d\u79f0\uff0c \u7f38\u53f7\uff0c\u5171'{'\u9001\u8d27\u5355\u5377\u6570'}'\u5377\r \u62a5\u544a OK",children:(0,j.jsx)("div",{children:"\u81ea\u52a8\u751f\u6210"})})]})})}));var b=l(24974),f=l.n(b);const v=async e=>{const n=[],l=[];for(const s of e){const e=new FileReader;e.readAsArrayBuffer(s);const t=new Promise(((l,t)=>{e.onload=async e=>{const t=e.target?.result,a=new(f().Workbook);await a.xlsx.load(t);const o=a.getWorksheet("\u9001\u8d27\u5355\u660e\u7ec6"),r=[];o.eachRow(((e,n)=>{const l={};e.eachCell({includeEmpty:!0},((e,n)=>{l[m[o.getCell(1,n).value]]=e.value})),1!==n&&r.push(l)}));const i=s.name.match(/[\u4e00-\u9fa5]+/);n.push({name:i?i[0]:s.name,deliveryList:r}),l()},e.onerror=t}));l.push(t)}return await Promise.all(l),n},_=(e,n)=>{const l=new Blob([e],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});return new File([l],n,{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"})};function S(e){return function(e){let n="",l=e;for(;l>0;){l--;let e=l%26;n=String.fromCharCode(e+65)+n,l=Math.floor(l/26)}return n||"A"}(u.findIndex((n=>n.key===e))+1)}var w=l(2543),k=l.n(w),R=l(95093),C=l.n(R);const A={top:{style:"thin"},left:{style:"thin"},bottom:{style:"thin"},right:{style:"thin"},diagonal:{style:"thin"}},L=async(e,n)=>{const l=new(f().Workbook),s=l.addWorksheet(C()().format("YYYYMMDD")),t=u;if(s.columns=t,((e,n)=>{e.getCell("A1").value="Lintas Company Limited",e.getCell("A2").value="2A, Dragon Industrial Bldg., 93 King Lam Street, Cheung Sha Wan, Kowloon, Hong Kong.",e.getCell("A3").value="Tel : (852) 2311 8028 / Fax : (852) 2311 2262",e.getCell("A4").value="DELIVERY TO : Lintas Bangladesh Co. Ltd.",e.getCell("A5").value="SFB # 5, Adamjee Export Processing Zone;Siddhirganj, Narayanganj, Bangladesh ",e.getCell("A6").value="VAT + BIN no. 000150053-0305      ATTN: Mr. Sujit        Tel no. 8801774-950646",e.getCell("A7").value="TEL : (852) 2311 8028 ",e.getCell("A8").value="***packing list ***(UPDATE)",e.mergeCells("A8:N8"),e.getCell("D9").value="Invoice no.",e.getCell("E9").value=n.invoice_no,e.getCell("F9").value="packing list no.",e.getCell("G9").value=n.packing_list_no,e.getCell("H9").value="Date",e.getCell("I9").value=new Date,e.getCell("I9").numFmt="d-mmm-yy",e.eachRow((e=>{e.eachCell((e=>{e.font={name:"Calibri",size:11}}))})),e.getRow(d).values=u.map((e=>e.englishName)),e.getRow(d).font={name:"Tahoma",size:11},e.getRow(11).values=u.map((e=>e.name)),e.getRow(11).font={name:"Tahoma",size:11}})(s,e),n.length<1)return l;let a=-1;n.forEach((n=>{const l=n.deliveryList.map((l=>{const s=[...new Set(n.deliveryList.map((e=>e.dyeing_vat_number)))],t=e.case_number.split("-"),o=t[0]+"-"+t[1]+"-",r=t[2];a++;const i=`${o}${Number(r)+a}`;l.case_number=i,l.unit="Y"===l.unit?"YD":l.unit;const c=y[l.product_number];return{case_number:i,roll_qty:Number(e.roll_qty),unit:e.unit,order_no:l.customer_order_number??"error",compostion:c??"error",description:l.product_number??"error",color:l.color_name??"error",width:e.width,qty:l.quantity??"error",length_unit:l.unit??"error",net_weight:l.net_total_kg??"error",gross_weight:l.net_total_kg?l.net_total_kg+.5:"error",meas:e.meas,remark:`${l.customer_order_number??""}, ${l.product_number??""}, ${l.color_number??""}, ${l.color_name??""}\n\n\u7f38\u53f7${s.map((e=>e)).join("\u3001")}, \u5171${n.deliveryList.length??0}\u5377 \u62a5\u544aOK`}})),o=s.lastRow.number;s.addRows(l).map((e=>{e.font={name:"Tahoma",size:10};const n=t.findIndex((e=>"gross_weight"===e.key))+1,l=S("net_weight");e.getCell(n).value={formula:`${l}${e.number}+0.5`}}));const r=S("remark");s.mergeCells(`${r}${o+1}:${r}${o+l.length}`);const i={roll_qty:n.deliveryList.length,qty:n.deliveryList.reduce(((e,n)=>e+Number(n.quantity??0)),0),net_weight:n.deliveryList.reduce(((e,n)=>e+Number(n.net_total_kg??0)),0),gross_weight:n.deliveryList.reduce(((e,n)=>e+Number(n.net_total_kg??0)+.5),0),remark:"\u5408\u8ba1"},c=s.addRow(i);c.eachCell({includeEmpty:!0},(e=>{if("roll_qty"===e._column._key){const n=S("roll_qty");e.value={formula:`SUM(${n}${o+1}:${n}${c.number-1})`,result:i.roll_qty}}if("qty"===e._column._key){const n=S("qty");e.value={formula:`SUM(${n}${o+1}:${n}${c.number-1})`,result:i.qty}}if("net_weight"===e._column._key){const n=S("net_weight");e.value={formula:`SUM(${n}${o+1}:${n}${c.number-1})`,result:i.net_weight}}if("gross_weight"===e._column._key){const n=S("gross_weight");e.value={formula:`SUM(${n}${o+1}:${n}${c.number-1})`,result:i.gross_weight}}e.border=A,e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.font={name:"Tahoma",size:10,bold:!0,color:{argb:"FFFF0000"}}}))})),s.getRow(s.lastRow.number+1).height=80;const o=s.lastRow.number+1;let r=11;n.forEach(((e,n)=>{const l=s.getRow(o+n),t=e.deliveryList[0];r+=e.deliveryList.length+1,l.getCell(1).value=t.customer_order_number,l.getCell(2).value=t.product_number,l.getCell(3).value=t.color_name,l.getCell(4).value="SUM:",l.getCell(5).value="rolls",l.getCell(6).value={formula:`B${r}`},l.getCell(7).value="Y"===t.unit?"YD":t.unit,l.getCell(8).value={formula:`I${r}`},l.getCell(9).value="NET:",l.getCell(10).value={formula:`K${r}`},l.getCell(11).value="GROSS:",l.getCell(12).value={formula:`L${r}`},l.getCell(13).value={formula:"N"+(r-e.deliveryList.length)},l.font={name:"Tahoma",size:10},s.mergeCells(`M${l.number}:N${l.number}`)}));const i=s.getRow(s.lastRow.number+1);return i.getCell(4).value="TOTAL:",i.getCell(5).value="rolls",i.getCell(6).value={formula:`SUM(F${o}:F${o+n.length-1})`},i.getCell(7).value="Y"===n[0].deliveryList[0].unit?"YD":n[0].deliveryList[0].unit,i.getCell(8).value={formula:`SUM(H${o}:H${o+n.length-1})`},i.getCell(9).value="NET:",i.getCell(10).value={formula:`SUM(J${o}:J${o+n.length-1})`},i.getCell(11).value="GROSS:",i.getCell(12).value={formula:`SUM(L${o}:L${o+n.length-1})`},i.eachCell((e=>{e.border=A,e.fill={type:"pattern",pattern:"solid",fgColor:{argb:"FFFFFF00"}},e.font={name:"Tahoma",size:10,bold:!0,color:{argb:"FFFF0000"}}})),s.eachRow(((e,n)=>{e.eachCell(((e,l)=>{n>7&&(e.alignment={horizontal:"center",vertical:"middle",wrapText:!0}),n>9&&l<t.length+1&&(e.border=A)})),n>11&&(e.height=80)})),l},$=(e,n)=>{const l={fileName:"\u7075\u8fbe\u6807\u5bfc\u51fa",list:[]};return l.fileName="\u7075\u8fbe\u6807 "+e.deliveryList[0].product_number+" "+e.deliveryList[0].color_number+" "+e.deliveryList.length+" \u5377",e.deliveryList.forEach((e=>{l.list.push({case_number:e.case_number,customer_order_number:e.customer_order_number,product_number:e.product_number,customer_color_number:e.customer_color_number,meas:"20*20*150",quantity:e.quantity,unit:e.unit,packing_list_no:n.packing_list_no})})),l};var F=l(62368),z=l.n(F);const I=e=>{let{buffer:n}=e;return(0,s.useEffect)((()=>{z().transformExcelToLucky(n,((e,n)=>{e.sheets[0].zoomRatio=1,window.luckysheet&&window.luckysheet.create&&window.luckysheet?.create({container:"excel",lang:"zh",showinfobar:!1,enableAddBackTop:!1,data:e.sheets,hook:{workbookCreateAfter:()=>{console.log("workbookCreateAfter------------")}}})})),setTimeout((()=>{const e=document.getElementsByClassName("luckysheet-grid-window-2")[0];if(e){const n=e.getElementsByClassName("luckysheet-paneswrapper");for(let e=0;e<n.length;e++)n[e].style.padding="0px"}const n=document.getElementsByClassName("luckysheet-scrollbar-ltr");for(let l=0;l<n.length;l++)n[l].style.zIndex="1"}),100)}),[n]),(0,j.jsx)("div",{id:"excel",className:N["preiew-luckysheet"]})};var P=l(71710),q=l.n(P),M=l(4213),T=l(78478);function E(){const[e,n]=s.useState([]),[d,u]=s.useState([]),[y,p]=s.useState([]),[h,g]=s.useState(),[b,f]=s.useState(null),S=(0,s.useRef)(!1),w=(0,s.useRef)(0),R=(0,s.useRef)(),A={name:"file",multiple:!0,fileList:y,accept:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet, application/vnd.ms-excel",customRequest:async e=>{const{onSuccess:n,file:l}=e;return n({status:"success",response:l}),{abort(){}}},onChange:async e=>{if(S.current)return void(S.current=!1);w.current++;const n=e.fileList.every((e=>"done"===e.status));if(w.current===e.fileList.length&&!n){const n=e.fileList.filter((e=>"uploading"===e.status)).length,l=e.fileList.map((e=>({...e,status:"done"})));p(l),w.current-=n}w.current===e.fileList.length&&n&&(o.Ay.success(`total ${e.fileList.length} file load successfully.`),F(e.fileList))},onRemove:async e=>{const n=y.filter((n=>n.uid!==e.uid));p(n),o.Ay.success(`remove ${e.name} file successfully.`),w.current--,S.current=!0,F(n)}},F=async e=>{const l=R.current?.getFieldsValue()||{};let s=[];e&&(s=await v(e.map((e=>e.originFileObj))));const t=await L(l,s),a=await t.xlsx.writeBuffer();n(s),g(a),f(t)};(0,s.useEffect)((()=>{const e=[];for(const[n,l]of Object.entries(m))e.push({title:n,dataIndex:l,key:l});e.push({title:"\u7bb1\u53f7",dataIndex:"case_number",key:"case_number"}),u(e),F()}),[]);k().flatMap(e,(e=>e.deliveryList));return(0,j.jsx)(t.A,{title:"Hello",description:"Hello React Page",children:(0,j.jsx)(T.A,{fallback:(0,j.jsx)("div",{children:"Loading..."}),children:()=>{const n=l(5135),s=l(3227),t=l(36317),o=l(50470);return(0,j.jsx)("div",{className:N["delivery-wrap"],children:(0,j.jsxs)("div",{className:N["delivery-content"],children:[(0,j.jsx)("div",{className:N["excel-preview"],children:(0,j.jsx)(I,{buffer:h})}),(0,j.jsxs)("div",{className:N["deliver-right"],children:[(0,j.jsxs)("div",{className:N.first,children:[(0,j.jsxs)("span",{style:{marginRight:"8px"},children:[(0,j.jsx)("div",{className:N.step,children:"1"}),"\u4e0a\u4f20\u7cfb\u7edf\u9001\u8d27\u5355"]}),(0,j.jsx)(r.A,{...A,children:(0,j.jsx)(i.Ay,{type:"primary",icon:(0,j.jsx)(a.A,{}),children:"Upload"})})]}),(0,j.jsxs)("div",{className:N.second,children:[(0,j.jsx)("div",{className:N.step,children:"2"}),"\u4fee\u6539\u6838\u5bf9\u5b57\u6bb5\u4fe1\u606f",(0,j.jsx)(x,{ref:R,onFormValueChange:k().debounce((()=>F(y)),500)})]}),(0,j.jsxs)("div",{className:N.third,children:[(0,j.jsxs)("span",{style:{marginRight:"8px"},children:[(0,j.jsx)("div",{className:N.step,children:"3"}),"\u5bfc\u51fa\u88c5\u7bb1\u5355\u548c\u6807\u7b7e"]}),(0,j.jsx)(c.A,{offsetBottom:0,children:(0,j.jsx)(i.Ay,{type:"primary",onClick:async()=>{const l=new(q()),a=R.current?.getFieldsValue()||{},r=e.reduce(((e,n)=>e+n.deliveryList.length),0),i=_(h);l.file(`${a.invoice_no}\u88c5\u7bb1\u5355${r}\u5377.xlsx`,i);const c=e.map((async e=>{const r=$(e,a);return await((e,l)=>new Promise(((a,r)=>{t.getBinaryContent("/runlam-website/template/LStemplate.docx",((t,r)=>{if(t)throw t;const i=new s(r),c=new n(i,{paragraphLoop:!0,linebreaks:!0,parser:o});c.render(e);const d=c.getZip().generate({type:"blob",mimeType:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"});return l.file(e.fileName+".docx",d),a(d)}))})))(r,l)}));await Promise.all(c),l.generateAsync({type:"blob"}).then((e=>{(0,M.saveAs)(e,`\u7075\u8fbe\u51fa\u8d27${C()().format("YYYY-MM-DD")}.zip`)}))},children:"\u5bfc\u51fa"})})]})]})]})})}})})}},35358:(e,n,l)=>{var s={"./af":25177,"./af.js":25177,"./ar":61509,"./ar-dz":41488,"./ar-dz.js":41488,"./ar-kw":58676,"./ar-kw.js":58676,"./ar-ly":42353,"./ar-ly.js":42353,"./ar-ma":24496,"./ar-ma.js":24496,"./ar-ps":6947,"./ar-ps.js":6947,"./ar-sa":82682,"./ar-sa.js":82682,"./ar-tn":89756,"./ar-tn.js":89756,"./ar.js":61509,"./az":95533,"./az.js":95533,"./be":28959,"./be.js":28959,"./bg":47777,"./bg.js":47777,"./bm":54903,"./bm.js":54903,"./bn":61290,"./bn-bd":17357,"./bn-bd.js":17357,"./bn.js":61290,"./bo":31545,"./bo.js":31545,"./br":11470,"./br.js":11470,"./bs":44429,"./bs.js":44429,"./ca":7306,"./ca.js":7306,"./cs":56464,"./cs.js":56464,"./cv":73635,"./cv.js":73635,"./cy":64226,"./cy.js":64226,"./da":93601,"./da.js":93601,"./de":77853,"./de-at":26111,"./de-at.js":26111,"./de-ch":54697,"./de-ch.js":54697,"./de.js":77853,"./dv":60708,"./dv.js":60708,"./el":54691,"./el.js":54691,"./en-au":53872,"./en-au.js":53872,"./en-ca":28298,"./en-ca.js":28298,"./en-gb":56195,"./en-gb.js":56195,"./en-ie":66584,"./en-ie.js":66584,"./en-il":65543,"./en-il.js":65543,"./en-in":9033,"./en-in.js":9033,"./en-nz":79402,"./en-nz.js":79402,"./en-sg":43004,"./en-sg.js":43004,"./eo":32934,"./eo.js":32934,"./es":97650,"./es-do":20838,"./es-do.js":20838,"./es-mx":17730,"./es-mx.js":17730,"./es-us":56575,"./es-us.js":56575,"./es.js":97650,"./et":3035,"./et.js":3035,"./eu":3508,"./eu.js":3508,"./fa":119,"./fa.js":119,"./fi":90527,"./fi.js":90527,"./fil":95995,"./fil.js":95995,"./fo":52477,"./fo.js":52477,"./fr":85498,"./fr-ca":26435,"./fr-ca.js":26435,"./fr-ch":37892,"./fr-ch.js":37892,"./fr.js":85498,"./fy":37071,"./fy.js":37071,"./ga":41734,"./ga.js":41734,"./gd":70217,"./gd.js":70217,"./gl":77329,"./gl.js":77329,"./gom-deva":32124,"./gom-deva.js":32124,"./gom-latn":93383,"./gom-latn.js":93383,"./gu":95050,"./gu.js":95050,"./he":11713,"./he.js":11713,"./hi":43861,"./hi.js":43861,"./hr":26308,"./hr.js":26308,"./hu":90609,"./hu.js":90609,"./hy-am":17160,"./hy-am.js":17160,"./id":74063,"./id.js":74063,"./is":89374,"./is.js":89374,"./it":88383,"./it-ch":21827,"./it-ch.js":21827,"./it.js":88383,"./ja":23827,"./ja.js":23827,"./jv":89722,"./jv.js":89722,"./ka":41794,"./ka.js":41794,"./kk":27088,"./kk.js":27088,"./km":96870,"./km.js":96870,"./kn":84451,"./kn.js":84451,"./ko":63164,"./ko.js":63164,"./ku":98174,"./ku-kmr":6181,"./ku-kmr.js":6181,"./ku.js":98174,"./ky":78474,"./ky.js":78474,"./lb":79680,"./lb.js":79680,"./lo":15867,"./lo.js":15867,"./lt":45766,"./lt.js":45766,"./lv":69532,"./lv.js":69532,"./me":58076,"./me.js":58076,"./mi":41848,"./mi.js":41848,"./mk":30306,"./mk.js":30306,"./ml":73739,"./ml.js":73739,"./mn":99053,"./mn.js":99053,"./mr":86169,"./mr.js":86169,"./ms":73386,"./ms-my":92297,"./ms-my.js":92297,"./ms.js":73386,"./mt":77075,"./mt.js":77075,"./my":72264,"./my.js":72264,"./nb":22274,"./nb.js":22274,"./ne":8235,"./ne.js":8235,"./nl":92572,"./nl-be":43784,"./nl-be.js":43784,"./nl.js":92572,"./nn":54566,"./nn.js":54566,"./oc-lnc":69330,"./oc-lnc.js":69330,"./pa-in":29849,"./pa-in.js":29849,"./pl":94418,"./pl.js":94418,"./pt":79834,"./pt-br":48303,"./pt-br.js":48303,"./pt.js":79834,"./ro":24457,"./ro.js":24457,"./ru":82271,"./ru.js":82271,"./sd":1221,"./sd.js":1221,"./se":33478,"./se.js":33478,"./si":17538,"./si.js":17538,"./sk":5784,"./sk.js":5784,"./sl":46637,"./sl.js":46637,"./sq":86794,"./sq.js":86794,"./sr":45719,"./sr-cyrl":3322,"./sr-cyrl.js":3322,"./sr.js":45719,"./ss":56e3,"./ss.js":56e3,"./sv":41011,"./sv.js":41011,"./sw":40748,"./sw.js":40748,"./ta":11025,"./ta.js":11025,"./te":11885,"./te.js":11885,"./tet":28861,"./tet.js":28861,"./tg":86571,"./tg.js":86571,"./th":55802,"./th.js":55802,"./tk":59527,"./tk.js":59527,"./tl-ph":29231,"./tl-ph.js":29231,"./tlh":31052,"./tlh.js":31052,"./tr":85096,"./tr.js":85096,"./tzl":79846,"./tzl.js":79846,"./tzm":81765,"./tzm-latn":97711,"./tzm-latn.js":97711,"./tzm.js":81765,"./ug-cn":48414,"./ug-cn.js":48414,"./uk":16618,"./uk.js":16618,"./ur":57777,"./ur.js":57777,"./uz":57609,"./uz-latn":72475,"./uz-latn.js":72475,"./uz.js":57609,"./vi":21135,"./vi.js":21135,"./x-pseudo":64051,"./x-pseudo.js":64051,"./yo":82218,"./yo.js":82218,"./zh-cn":52648,"./zh-cn.js":52648,"./zh-hk":1632,"./zh-hk.js":1632,"./zh-mo":31541,"./zh-mo.js":31541,"./zh-tw":50304,"./zh-tw.js":50304};function t(e){var n=a(e);return l(n)}function a(e){if(!l.o(s,e)){var n=new Error("Cannot find module '"+e+"'");throw n.code="MODULE_NOT_FOUND",n}return s[e]}t.keys=function(){return Object.keys(s)},t.resolve=a,e.exports=t,t.id=35358}}]);